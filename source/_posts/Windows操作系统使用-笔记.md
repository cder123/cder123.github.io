---
title: Windows操作系统使用-笔记
tag: Windows
categories:
  - [后端,操作系统,Windows使用]
---

# Windows操作系统使用-笔记

[toc]



## 1. Windows-磁盘管理

![windows磁盘管理](https://z3.ax1x.com/2021/06/02/2QD0v8.png)



![windows磁盘管理-2](https://z3.ax1x.com/2021/06/02/2QDg5n.png)









## 2. DOS

[批处理笔记-链接](https://blog.csdn.net/m0_46578592/article/details/110527563)

#### 1. 更改cmd 的*窗口背景色*及*字体颜色*

```dos
  颜色属性由两个十六进制数字指定 --(如： color fc)

			  第一个	 十六进制数字 对应于背景

			  第二个    十六进制数字 对应于前景


	  每个数字
		可以为以下任何值:

				 0=黑色       8=灰色

			  	 1=蓝色       9=淡蓝色

			   	 2=绿色       A=淡绿色

			   	 3=浅绿色     B=淡浅绿色

		    	 4=红色       C=淡红色

		    	 5=紫色       D=淡紫色

		    	 6=黄色       E=淡黄色

		    	 7=白色       F=亮白色  

		  

	如果没有给定任何参数，此命令会将颜色还原到 cmd.exe 启动时的颜色。

			这个值来自当前控制台窗口、
			/T 命令行开关,
			或 DefaultColor 注册表	值。  



	
	如果尝试使用相同的	前景和背景颜色  来执行  COLOR 命令，COLOR 命令会将 ERRORLEVEL 设置为 1。  



 
	示例: "COLOR fc" 在亮白色上产生淡红色

		  color 0a		//第一个对应于背景，第二个对应于前景		    	 
```










#### 2. ipconfig

 ```dos
ipconfig                       ... 显示信息

ipconfig /all                  ... 显示详细信息

ipconfig /renew                ... 更新所有适配器

ipconfig /renew EL*            ... 更新所有名称以 EL 开头的连接

ipconfig /release *Con*        ... 释放所有匹配的连接，
                                         例如“有线以太网连接 1”或
                                             “有线以太网连接 2”
                                             
ipconfig /allcompartments /all ... 显示有关所有隔离舱的详细信息                                             
ipconfig /allcompartments      ... 显示有关所有隔离舱的信息
 ```





#### 3. net user(显示所有 网络用户账号)





#### 4. 文件管理

>    文件路径			  							   : `D:\abc\1.txt`
>    列出文件(包括隐藏的)					   : `dir  /a	`
>    执行完命令后**不退出cmd**    			 : `pause `
>    改变窗口**标题**		  						  : `title 想要的标题`
>    **清屏**				  								 : `cls  `
>    **读取**文件				  						 :` type 文件名`
>    将**源文件内容**输出到**目标文件**	    : `copy 源文件 目标文件 `,`例如： copy con ./1.txt`  
>    **剪切**文件						       		: `move  源文件全名 	目标文件全名`  
>    设置**隐藏文件**		: `attrib  +/- h   文件名.后缀`   ,其中： `h隐藏文件 , s系统级的文件 ，a追加写`  
>
>    **隐藏当前文件夹**内部的所有文件	: 只输入 attrib 
>
>    **创建文件**										  ： `fsutil  file  createnew  文件名   文件大小（单位：字节）` 
>
>    ```dos
>    例如：
>    		fsutil  file  createnew  d:\system.ini   文件大小(单位：字节)  
>    
>    			如果配合  attrib +a;+s;+h   就可以减少硬盘存储而找不到原因  
>    ```
>
>    **创建文件夹**							  : `md 文件夹名`		
>
>    **文件/文件夹重命名**				: `ren  旧名  新名` 
>
>    **删除文件**								 : `del  文件名`											
>
>    ```dos
>    例如：	del *.* /s/q  >nul   2>nul    
>        
>    	  //删除所有文件，
>    	  		/s 表示递归 ，
>    	  		/q表示让系统不再弹出确认的询问信息，
>    	  		1>nul 不再弹出正确提示，
>    	  		2>nul 不再弹出错误提示	
>    ```
>
>     **删除文件夹**						: `rd  文件夹名	`
>
>     更改**文件关联性** 
>
>    ```dos
>    assoc  .txt = exefile			
>    						//将txt文件与exe文件关联，让系统认为 txt程序 是 exe程序
>    
>    assoc  .txt = txtfile	
>    						//改回来
>    ```

#### 5. 杀进程

>`taskkill -im 进程名(如:notepad.exe) /f  >nul 2>nul`														
>
>​											表示：杀死进程，强制，不提示正确/错误 信息  

#### 6.关机/重启/注销:

```dos
shutdown -s -t 时间（秒）				//关机，；-r 重启；-f 强制执行；-c “ 提示信息xxx”

shutdown -s -f -t  秒数  -c "文字xxx"

shutdown -a								// -a 可以取消命令

shutdown -l 							//注销，==logoff
```



#### 7. 输出

>    输出空行			: `echo.`    
>
>    路径提示			: 	
>
>    ​							@echo off  		//关掉路径提示信息
>    ​							@echo on		//开启路径提示信息  

#### 8.  查看本地开放的所有端口：[1个端口对应1个服务]

>   netstat -an









##  3. 批处理脚本

win10 启动路径：

+   C:\ProgramData\Microsoft\Windows\Start Menu\Programs

```
后缀 	：  .bat

作用	：  自上而下，执行命令，直到执行完所有命令（即使中间有命令无法执行，也不会停止）

命令	：  dos命令


	设置变量： set a=1
	取变量	：  %a%
	
	由用户输入变量的值： set /p a=
	
	位置变量(代表参数)： 如 shutdown -s -t %1
	
					0:代表批处理本身
					1：代表第一个参数	
	
	跳转命令：  【  ：和 goto 连用  】	 
```











## 4. 用户管理

#### 1. SID

在 Windows中 每个登录到系统的用户都有相应的用户ID【UID】

+   用户ID = 系统ID（SID） + 用户编号
+   用户编号：管理员（500），普通（1000）
+   账号与密码存放在 【C:\Windows\System32\config\SAM】，使用哈希算法【不可逆。安全】

#### 2. 系统默认账号【基本的5个】

+   给人使用的：
    +   administrator:管理员
    +   guest：来宾【默认禁用】
+   给计算机使用的：
    +   system：系统账户，权力最高
    +   local services：本地服务账户，普通用户
    +   network services : 网络服务账户，普通用户

#### 3. 每个用户都有自己的home目录【存放配置文件】

即：profile

如： 【C:\Users】

查看 当前用户: whoami 

查看 当前用户的SID：whoami /user

在管理员权限下：

cmd:

+   【修改密码】net user 用户名 密码
+   【新建用户】net user  用户名 密码  /add
+   【删除用户】net user 用户名 /del
+   【查看用户】net user
+   【激活/禁用账户】 net user  用户名   /active: yes/no

#### 4. 用户组

为简化权限设置【给组划分权限，将相应权限的用户划分到相应组】

+   管理员
+   来宾
+   用户
+   网络
+   打印机
+   远程桌面

**cmd命令：**

+   【查看所有本地组】：net	 localgroup 	
+   【查看指定的用户组】： net  localgroup 用户组名
+   【添加用户到指定的用户组】： net  localgroup 用户组名 用户名   /add
+   【删除用户到指定的用户组】： net  localgroup 用户组名 用户名   /del

添加用户/用户组：

+   右键计算机
+   管理
+   用户/用户组









## 5. 远程管理

####  1. 远程桌面【端口号：3389】

步骤：【如果**客户端不是管理员**，则需要在**服务器**上将该用户加入 **远程桌面用户组**】

+   保证 客户端 和 服务器之间 能够 ping通
+   服务器 允许被 远程访问：
    +   桌面右键属性
    +   远程设置
    +   选择允许
    +   确定
+   客户端上
    +   win + R
    +   mstsc
    +   输入IP地址
    +   确定
    +   输入用户名和密码

#### 2. telnet

步骤：

服务器：

+   将账户加入到 telnet客户机组

客户端：

+   在service.msc中开启telnet服务[xp]，在cmd中使用telnet







## 6. 文件共享

【CIFS 协议，445端口（tcp和udp都有）】

+   右键
+   文件/文件夹
+   共享
+   高级共享	

-	共享此文件夹
-	设置共享名（指的是客户端远程访问该共享文件夹时看到的文件夹名）
    -	共享名后加1个$表示是隐藏的共享文件
-	设置权限（共享文件夹的权限收到共享权限和NTFS权限共同影响）
-	访问：win+R ,输入：`\\地址`

创建共享：

+   cmd
+   net share 共享名= 路径【如：net share c$ = c:\】

默认情况下所有盘符都共享【不安全！！】：

因此，需要关闭共享：

+   方法1：
    +   右键-计算机-管理-服务-找到server-禁用
+   方法2【暂时的，重启就失效】：
    +   cmd -输入 net share  共享名  /del 
+   方法3【修改注册表】
+   方法4：【防火墙的入站规则】
+   方法5：将删除共享的命令保存为批处理命令格式，然后放入启动目录







## 7. PE系统

PE:微型维修系统，由于容量小，只能用于维修

使用PE破解window密码步骤:

+   制作PE U盘
+   启动计算机进入BIOS后改为U启动
+   进入PE系统
+   使用破解工具【原理：**替换**掉原来系统中的**SAM**中计算出的账户密码的**哈希值**】
+   退出PE
+   切换回硬盘启动
+   使用修改后的密码







## 8. DHCP的部署与安全

【udp:67和68端口】


1.  dhcp相关：【ip，掩码，网关，dns， 租期】
2.  DHCP**租约**过程:
    1.  dhcp discovery:【客户机广播请求IP，请求包中有客户机的MAC地址】
    2.  DHCP服务器发送 offer广播包【包内有dhcp分配给客户机的ip,但没有掩码网关等参数】
    3.  客户机发送request广播包【客户机确认要使用的IP】
    4.  服务器DHCP ack 广播包【服务器确认租约，并发送ip,掩码,网关,dns,租约等参数】
3.  DHCP 的**续约**过程：
    1.  当租期达到**50%**时，客户机再次向服务器发送 dhcp request请求
    2.  如果没有响应，则继续使用至租约**87.5%**时再次向服务器发送 dhcp request请求
    3.  如果仍然没有响应，则释放ip地址，重新发送dhcp  discovery包
    4.  如果还没有响应，则分配 169.254.xxx.xxx/16(全球统一的无效地址，用于内网临时通信)
4.  DHCP服务器部署【服务器ip要与地址池ip在同一网段】
    1.  服务器有1个固定的IP
    2.  安装dhcp服务器插件
    3.  新建作用域和作用域选项
        1.  打开dhcp管理工具
        2.  右键，新建作用域
        3.  指定地址池名称
        4.  指定分配的ip范围及掩码
        5.  指定地址池中不想分配的地址
        6.  设置租约【默认8天】
        7.  设置作用域选项【即：网关、dns等】
    4.  激活[右键]
    5.  客户端验证
5.  DHCP常用命令：

    1.  ipconfig  /release【取消租约，释放 ip】
    2.  ipconfig /renew【没有ip时发送dsicovery,有ip时发送request手动续约】
6.  可以继续dhcp的备份和还原【右键dhcp管理页面】
7.  删除dhcp服务器页的服务器后，服务依然进行只是不显示，可以通过高级-查找出服务器来恢复显示。要想完全删除，必须删除作用域
8.  地址保留：对特点的Mac地址分配特定的ip
9.  **作用域选项**可以通过设置**服务器选项**批量配置【右键-配置选项】
10.  DHCP中各种选项的优先级：

     1.  作用域选项 > 服务器选项
11.  **DHCP攻击：**

     1.  **攻击DHCP服务器**：频繁发送伪装的dhcp请求，直到将地址池资源耗尽

         1.  防御措施：在**管理型交换机的端口**上做**动态MAC地址绑定**
     2.  **伪装DHCP服务器**：hack将自己部署为DHCP服务器

         1.  防御措施：在**管理型交换机上**设置除合法DHCP服务器的端口外，其他端口禁止发送dhcp offer包





## 9. DNS服务器部署

清除缓存DNS: `ipconfig  /flushdns`

查看dns缓存：`ipconfig  /displaydns`

1.  www:主机名,即给服务器取个名字叫www，管理员取名时一般按功能取【可以**自定义**】

2.  baidu.com:域名【这部分是花钱**购买**的】

3.  主机名.域名：完全限定域名(FQDN)【如：www.baidu.com】

4.  根域名：使用小数点<kbd>.</kbd>表示,【浏览器默认补全，不需要手动输入】

5.  域名分类【树状】：
    +   根域名
    +   ​	顶级域名【紧跟根域名的就是顶级域名，如：.com  ,  .cn  ,  .uk等】	

6.  DNS使用TCP 、UDP 的 **端口** **53**

7.  DNS**查询过程**：【递归找本地dns服务器，迭代找具体的服务器】
    +   缓存
    +   hosts文件
    +   本地dns服务器
    +   根域
    +   顶级域
    +   一级域名……

8.  DNS**查询的分类**：
    +   正向解析：已知域名 -找》IP
    +   反向解析：已知IP -解析》域名

9.  **部署步骤**【正向】：

    1.  打开dns服务器管理工具

    2.  右键正向区域-创建区域

        1.  主要区域：主dns服务器 
        2.  辅助区域：备份dns服务器
        3.  存根区域：根域名

        【权威应答：直接向**管理 被访问的主机 的dns服务器**询问后得到的回答】

    3.  输入区域名【域名】
    4.  创建1个用于解析的区域文件【拓展名 .dns】
    5.  下一步。。。完成

10.  部署后在正向区域出现2条默认记录

     1.  SOA : 宣告谁是权威服务器，世界唯一
     2.  名称服务器NS：告诉别人当前可以由哪台服务器解析

11.  添加解析记录：

     1.  正向区域右键
     2.  新建主机【A记录，一种正向解析记录】
     3.  输入名称【主机名，如：www】
     4.  输入IP地址【该ip地址会与上面的地址解析关联，档解析解析上面的域名时，返回该ip地址】







## 10. WEB服务器

http: tcp 80 端口

htts: tcp 443 端口

常用的web服务器发布软件：iis / apache/nginx/tomcat

1.  部署web服务器**步骤**：
    1.  配置静态IP
    2.  安装IIS【安装iis后会自动创建1个以 iuser 开头的匿名用户】
    3.  网站默认存放在 c:\Inetpub下







## 11. FTP

【推荐软件】：`Wing FTP Server`

端口号：tcp 20/21端口

ftp的两种工作模式：

+   主动模式
+   被动模式

ftp用户的最终权限 = ftp权限  与  ntfs权限 的交集

建议：设置ftp站点时勾选所有ftp权限，具体权限的设置在ntfs中完成

用户名和密码一般新建1个用户供他人使用

推荐的第三方ftp服务软件【20人以内】：slyar ftp server ; serv-U【百人以内】





## 12. 域和活动目录

1.   计算机一般有两种工作环境：
    +   工作组【人人平等】
    +   域【人人不平等】
2.   1个域 由 域控制器 (**DC)** 控制【通常：**域控制器**也是 **域内的DNS服务器**】
3.    通常1台计算机**加入域后，本地账户就失效**，只能使用域账户，域账户的用户名和密码存放在**DC**的一张资源表中【即：活动目录AD，**AD是属于整个域的资源**】，在登录 域中的某一台计算机时，计算机会利用DNS服务找到DC，DC会将接收到的用户名密码与AD表中的条目 相比对，如果在AD中有该用户名和密码，则允许该客户端登录
4.   在DC上，还可以设置组策略，对域内的计算机进行统一的管控
5.  计算机**登录到域**后可以**访问域资源**【只有用域账户登录才行】
6.  **安装步骤：**
    1.  在要配置成DC的服务器上配置**静态IP**【不需要配置dns】
    2.  【win+R => 输入 dcpromo】
    3.  勾选 “通过在计算机上安装DNS服务器进行自动更正”
    4.  勾选“新林中新建域”【适用于第一次建域】
    5.  输入该域的**根级域名**【该域的下面的子域名（如mail.baidu.com）都写在根级域名（baidu.com）的前面，】
    6.  设置**林的功能级别**【若设为window server 2008r2，那么今后该林内的新建的dc只能是2008r2以上的版本】
    7.  设置**域功能级别**【域功能级别只对当前域有效，其子域受林功能基本控制】
    8.  一直确定【不要更改默认路径！！（活动目录就是ntds数据库文件，sysvol就是组策略）】
    9.  设置活动目录的**还原密码**【该密码只在做还原域的操作时有用】
    10.  安装后重启
7.  当1台服务器成为域中的DC后，该服务器【DC】上原来的本地账户自动迁移到AD表中【登录时可以看到：（用户名变为：qf\admin  ， 其中：qf为域名，admin为原来的本地账户）】
8.  打开 “AD用户和计算机”，展开域名，在展开的项中
    1.  computers：域中的普通成员
    2.  domain controller:域控制器
    3.  users：域账户【部分账号 来自 该计算机原先的本地账户】
9.  将普通的计算机加入域：
    1.  将计算机 连入 域所在的网络【不需要配网关，但需要配dns(域控制器的ip),域控制器在配置ip的界面上要将dns配为运营商的dns使域能上外网】
    2.  右键“计算机” - “属性”-“计算机名更改设置”-输入要改成计算机的名字和域名
    3.  使用域管理员登录【qf.com\admin ; 123.com】
    4.  重启计算机
10.  在DC的**AD**上建立**普通域账户**给加入到**域的普通计算机**使用：
     1.  打开AD
     2.  右键“users”-“新建”-“用户”
     3.  输入姓和名
     4.  输入登录名。下一步
     5.  输入密码和确认密码
     6.  去掉“下次登录时更改密码”

11.  普通域用户对特定电脑有管理员权限：
     1.  用域管理员身份登录特定电脑
     2.  打开本地管理员组
     3.  查找位置为域 将该 普通域账户 加入到特定电脑的 本地管理员组 中
12.  **加入域不成功**的原因：
     1.  网络不通
     2.  dns解析不成功
     3.  dns缓存
13.  **登录域不成功**的原因：
     1.  用户名错误
14.  OU：组织单元【用于对域资源 **(即：域用户，域计算机，域组)** 进行归类】
15.  组和OU的区别：
     1.  组：为了赋予组内的账户权限
     2.  OU：为了下发 **组策略**

16.  创建OU:
     1.  打开AD，右键域名文件夹
     2.  新建-组织单元
     3.  输入ou的名字
     4.  完成
     5.  右键用户
     6.  所有任务
     7.  移动
     8.  选择要移到的OU
     9.  确定
17.  组策略【GPO】:通过组策略可以修改计算机的各种属性【开始菜单;桌面背景;网络参数等】
     1.  **组策略在域中是由OU下发的**
     2.  组策略下发后，用户的应用顺序【lsdou：本地-站点-域-组织单元】
     3.  开始-管理工具-组策略管理
     4.  组策略的3 种状态：【启用，禁止，未配置】
     
     

## 案例1

利用window 7 粘滞键 (在登录界面按5次shift)登录 不知道密码 的计算机

【C:\Windows\System32\sethc.exe】

步骤：

+   强制断电后开机
+   进入 启动修复界面
+   查看问题反馈【目的 : 打开txt】
+   打开路径并将粘滞键改名【路径：C:\Windows\System32\sethc.exe】
+   将cmd改名为粘滞键的文件名
+   重启
+   按5次shift 弹出
+   cmd中在管理员组中添加新用户
2.  新建-组织单元
     3.  输入ou的名字
     4.  完成
     5.  右键用户
     6.  所有任务
     7.  移动
     8.  选择要移到的OU
     9.  确定
17.  组策略【GPO】:通过组策略可以修改计算机的各种属性【开始菜单;桌面背景;网络参数等】
     1.  **组策略在域中是由OU下发的**
     2.  组策略下发后，用户的应用顺序【lsdou：本地-站点-域-组织单元】
     3.  开始-管理工具-组策略管理
     4.  组策略的3 种状态：【启用，禁止，未配置】
     
     

## 案例1

利用window 7 粘滞键 (在登录界面按5次shift)登录 不知道密码 的计算机

【C:\Windows\System32\sethc.exe】

步骤：

+   强制断电后开机
+   进入 启动修复界面
+   查看问题反馈【目的 : 打开txt】
+   打开路径并将粘滞键改名【路径：C:\Windows\System32\sethc.exe】
+   将cmd改名为粘滞键的文件名
+   重启
+   按5次shift 弹出
+   cmd中在管理员组中添加新用户
+   使用新用户登录